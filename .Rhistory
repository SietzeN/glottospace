africa <- glottofilter(continent = "Africa")
nrow(eurasia)
length(unique(eurasia$family_name))
nrow(australia)
length(unique(australia$family_name))
nrow(africa)
length(unique(africa$family_name))
sf::st_is_longlat(points)
points
sf::st_crs(points)
sf::st_crs(points) == NA
sf::st_is_longlat(data)
!sf::st_is_longlat(data)
is.na(sf::st_is_longlat(data))
load_all()
points <- contransform_lonlat(points)
glottologdata <- get_glottolog(data = "glottolog")
glottologdata <- glottologdata %>% dplyr::rename("glottocode" = "id")
glottospace <- glot2geoglot(glottologdata)
glottospace <- glottospace[,c("glottocode")]
glottospace
is_lonlat(glottospace)
funcsource(glot2geoglot)
load_all()
glottologdata <- get_glottolog(data = "glottolog")
glottologdata <- glottologdata %>% dplyr::rename("glottocode" = "id")
glottospace <- glot2geoglot(glottologdata)
glottospace <- glottospace[,c("glottocode")]
is_lonlat(glottospace)
glottologdata
glot2geoglot(glottologdata)
?sf::st_as_sf
glottospace <- glot2geoglot(glottologdata)
glottospace
sf::st_crs(glottospace) <- 4326
is_lonlat(glottospace)
sf::st_set_crs(glottospace, 4326)
is_lonlat(glottospace)
glottospacell <- glottospace %>% sf::st_set_crs(4326)
is_lonlat(glottospacell)
?sf::st_set_crs
?sf::st_set_crs
sf::st_crs(glottodata)
sf::st_crs(glottospace)
load_all()
glottologdata <- get_glottolog(data = "glottolog")
glottologdata <- glottologdata %>% dplyr::rename("glottocode" = "id")
glottospace <- glot2geoglot(glottologdata)
glottospace <- glottospace[,c("glottocode")]
sf::st_crs(glottospace)
is_lonlat(glottospace)
sf::st_is_longlat(glottospace)
load_all()
is_lonlat(glottospace)
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
glottodata
geodist(glottodata)
ds <- geodist(glottodata)
ds
pointdist_bird(glottodata)
glottodata
is_lonlat(glottodata_
is_lonlat(glottodata)
is_lonlat(glottodata)
glottospace <- get_glottospace()
is_lonlat(glottospace)
jn <- dplyr::left_join(x = glottodata, y = glottospace, by = id)
jn <- dplyr::left_join(x = glottodata, y = glottospace, by = "glottocode")
jn
glottodata <- glottoget()
jn <- dplyr::left_join(x = glottodata, y = glottospace, by = "glottocode")
jn
is_lonlat(jn)
glottodata <- dplyr::left_join(x = glottodata, y = glottospace, by = id)
is = "glottocode"
id = "glottocode"
id <- contrans_id2gc(id)
glottospace <- get_glottospace()
glottospacedata <- dplyr::left_join(x = glottodata, y = glottospace, by = id)
is_lonlat(glottospacedata)
sf::st_crs(glottospacedata) <- sf::st_crs(glottospace)
glottospacedata
class(glottospacedata)
sf::st_sf(glottospacedata)
is_lonlat(sf::st_sf(glottospacedata))
glottobase
glottodata <- get_glottodata(meta = FALSE)
glottodata <- glottoget(meta = FALSE)
glottodata <- glottoget(meta = FALSE)
join_glottobase(glottodata)
glottobase
load_all()
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
glottodata
geodist(glottodata)
ts <- geodist(glottodata)
ts
pointdist_bird(glottodata)
points <- glottodata
points <- contransform_lonlat(points)
points
geodist <- sf::st_distance(x = points)
geodist
geodist <- geodist %>% units::set_units(km) # convert with set_units because geodist %>% "/"(1000) would not keep the correct units class
rownames(geodist) <- points[, label, drop = T]
if(is.null(label)){label <- "glottocode"}
label <- "glottocode"
rownames(geodist) <- points[, label, drop = T]
colnames(geodist) <- points[, label, drop = T]
geodist <- round(geodist)
geodist
load_all()
geodist(glottodata)
dist <- geodist(glottodata)
dist
as.dist(geodist)
load_all()
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
dist <- geodist(glottodata)
dist
distdf <- join_glottodist(data = glottodata, dist = dist)
distdf <- join_glottodist(glottodata = glottodata, dist = dist)
distmat <- as.matrix(dist)
distmat
distdf <- as.data.frame(distmat)
data.table::setDT(distdf, keep.rownames = "id")
colnames(glottodata)[colnames(glottodata) == id] <- "id"
data.table::setDT(glottodata, keep.rownames = "id")
glottodata
sf::st_drop_geometry(glottodata)
glottodata <- glottoget()
glottodata
glottodata <- glottojoin(glottodata, with = "glottospace")
glottodat
glottodata
glottodata
glottodata <- glottojoin(glottodata, with = "glottospace")
get_glottospace()
glottospace <- get_glottospace()
glottospace
join_glottospace(glottodata)
glottojoin(glottodata, with = "glottospace")
with = "glottospace"
if(is_dist(with)){
joined <- join_glottodist(glottodata = glottodata, id = id, dist = with, rm.na = rm.na)
} else if(with == "glottobase"){
joined <- join_glottobase(glottodata = glottodata, id = id)
} else if(with == "glottospace"){
joined <- join_glottospace(glottodata = glottodata, id = id)
} else if(is_list(glottodata)){
joined <- join_glottodatalist(glottodatalist = glottodata)
} else if(is.data.frame(glottodata) & is.data.frame(with)){
joined <- join_glottodata(glottodata = glottodata, with = with)
} else(message("Class of input data not supported.") )
rm.na = FALSE
is_dist(with)
with
funcsource(is_dist)
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
load_all()
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
dist <- geodist(glottodata)
dist
glottojoin(glottodata, with = dist)
glottodata
dist
distmat <- as.matrix(dist)
distmat
distdf <- as.data.frame(distmat)
data.table::setDT(distdf, keep.rownames = "id")
colnames(glottodata)[colnames(glottodata) == id] <- "id"
data.table::setDT(glottodata, keep.rownames = "id")
glottodata
glottodata
st_drop_geometry(glottodata)
sf::st_drop_geometry(glottodata)
class(glottodata)
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
dist <- geodist(glottodata)
class(glottodata)
glottodata <- sf::st_drop_geometry(glottodata)
glottojoin(glottodata, with = dist)
rowna <- rowSums(is.na(distmat))
colna <- colSums(is.na(distmat))
rmcol <- which(colSums(is.na(distmat)) > min(colna))
rmrow <- which(rowSums(is.na(distmat)) > min(rowna))
if(!purrr::is_empty(rmcol)){  distmat <- distmat[,-rmcol] }
if(!purrr::is_empty(rmrow)){  distmat <- distmat[-rmrow,] }
distmat
distdf <- as.data.frame(distmat)
data.table::setDT(distdf, keep.rownames = "id")
colnames(glottodata)[colnames(glottodata) == id] <- "id"
data.table::setDT(glottodata, keep.rownames = "id")
distdf <- as.data.frame(distmat)
distdf
data.table::setDT(distdf, keep.rownames = "id")
glottodata
colnames(glottodata)[colnames(glottodata) == id]
colnames(glottodata)
id <- contrans_id2gc(id)
id
colnames(glottodata)[colnames(glottodata) == id] <- "id"
glottodata
colnames(glottodata)[colnames(glottodata) == id] <- "id"
data.table::setDT(glottodata, keep.rownames = "id")
dfjoin <- dplyr::inner_join(glottodata, distdf, by = "id") # not using by = c("a" = "b") because only works with character strings and not with id object
colnames(dfjoin)[colnames(dfjoin) == "id"] <- id
dfjoin
load_all()
joined <- join_glottodist(glottodata = glottodata, id = id, dist = with, rm.na = rm.na)
joined
glottodata
with
dist <- geodist(glottodata)
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
dist <- geodist(glottodata)
dist
glottojoin(glottodata, with = dist)
with = dist
is_dist(with)
with
glottodata
id = NULL
rm.na = FALSE
joined <- join_glottodist(glottodata = glottodata, id = id, dist = with, rm.na = rm.na)
glottodata
id
dist
rm.na
id <- contrans_id2gc(id)
distmat <- as.matrix(dist)
distmat
distdf <- as.data.frame(distmat)
data.table::setDT(distdf, keep.rownames = "id")
colnames(glottodata)[colnames(glottodata) == id] <- "id"
data.table::setDT(glottodata, keep.rownames = "id")
glottodata
glottodata
dfjoin <- dplyr::inner_join(glottodata, distdf, by = "id") # not using by = c("a" = "b") because only works with character strings and not with id object
glottodata <- glottoget()
glottodata <- glottojoin(glottodata, with = "glottospace")
dist <- geodist(glottodata)
glottojoin(glottodata, with = dist)
load_all()
glottojoin(glottodata, with = dist)
glottodatadist <- glottojoin(glottodata, with = dist)
glottodatadist
# Join with glottospace
glottodata <- glottoget()
glottodatabase <- glottojoin(glottodata, with = "glottobase")
createglottosubdata(glottocodes = c("yucu1253", "tani1257"), variables = 3, groups = c("a", "b"), n = 2, meta = FALSE)
createglottosubdata(glottocodes = c("yucu1253", "tani1257"), variables = 3, groups = c("a", "b"), n = 2)
glottojoin(glottodatalist)
glottojoin(glottodata = glottodatalist)
glottodatalist <- createglottosubdata(glottocodes = c("yucu1253", "tani1257"), variables = 3, groups = c("a", "b"), n = 2, meta = FALSE)
glottojoin(glottodata = glottodatalist)
load_all()
glottodatalist <- createglottosubdata(glottocodes = c("yucu1253", "tani1257"), variables = 3, groups = c("a", "b"), n = 2, meta = FALSE)
glottojoin(glottodata = glottodatalist)
ts <- glottojoin(glottodata = glottodatalist)
ts
install()
glottosearch(find = "Australia", columns = c("country", "continent"))
glottosearch(find = "Australia", columns = c("country", "region"))
glottosearch(find = "Australia", columns = c("region"))
glottosearch(find = "Australia", columns = c("continent"))
glottosearch(find = "Yucuni", columns = c("name", "family_name"))
document()
document()
load_all()
install()
glottodata <- glottoget()
glottodataspace <- glottojoin(glottodata, with = "glottospace")
glottodatabase <- glottojoin(glottodata, with = "glottobase")
# Join with a dist object
dist <- geodist(glottodata)
glottodata
eurasia <- glottofilter(continent = c("europe", "asia"))
eurasia
glottobase
?glottofilter
?glottodist
glottodata <- glottoget()
glottodata
glottodata <- glottoget(meta = TRUE)
glottodist(glottodata)
glottodata
is_list(sdf)
glottocheck_hasmeta(glottodata)
load_all()
glottocheck_hasmeta(glottodata)
glottodata["structure"]
glottodata[["structure"]]
structure <- glottodata[["structure"]]
load_all()
glottodata <- glottoget(meta = TRUE)
glottodist <- glottodist(glottodata = glottodata)
structure <- glottodata[["structure"]]
glottodata <- glottodata[["glottodata"]]
glottodata
structure
data.frame("colnames" = colnames(glottodata)
)
structure
colnames(glottodata) %in% structure$varname
load_all()
glottodata <- glottoget(meta = TRUE)
glottodist <- glottodist(glottodata = glottodata)
structure
!is.null(structure$weight)
structure$weight
structure
!is.null(structure)
types <- structure$type
types
levels <- structure$levels
is.null(structure$weight)
rep(1, ncol(glottodata)
)
glottodata
glottodata <- glottodata[["glottodata"]]
ncol(glottodata)
rep(1, ncol(glottodata))
colnames(glottodata) %in% structure$varname
colnames(glottodata)
glottodata[,colnames(glottodata) %in% structure$varname]
structure
weights <- structure$weight
weights
types
symm <- which(types == "symm")
asymm <- which(types == "asymm")
numer <- which(types == "numeric")
fact <- which(types == "factor")
ordfact <- which(types == "ordered")
ordratio <- which(types == "ordratio")
logratio <- which(types == "logratio")
# set types
cbinary <- c(symm, asymm)
glottodata[cbinary] <- lapply(glottodata[cbinary], as.logical)
glottodata[numer] <- lapply(glottodata[numer], as.numeric)
glottodata[fact] <- lapply(glottodata[fact], as.factor)
glottodata[ordfact] <- mapply(FUN = as.ordfact, x = glottodata[ordfact], levels = levels[ordfact])
glottodata[ordratio] <- lapply(glottodata[ordratio], as.numeric)
glottodata[logratio] <- lapply(glottodata[logratio], as.numeric)
dist <- cluster::daisy(x = glottodata, metric = "gower",
type = list(symm = symm, asymm = asymm, ordratio = ordratio, logratio = logratio),
weights = weights)
glottodata
dist <- cluster::daisy(x = data, metric = "gower",
type = list(symm = symm, asymm = asymm, ordratio = ordratio, logratio = logratio),
weights = weights)
data
data <- glottodata[,colnames(glottodata) %in% structure$varname]
data
dist <- cluster::daisy(x = data, metric = "gower",
type = list(symm = symm, asymm = asymm, ordratio = ordratio, logratio = logratio),
weights = weights)
dist
tibble::column_to_rownames(glottodata, "glottocode")
glottodata
glottodata <- glottoget(meta = TRUE)
glottodata <- glottodata[["glottodata"]]
glottodata
tibble::column_to_rownames(glottodata, "glottocode")
glottodata <- tibble::column_to_rownames(glottodata, "glottocode")
dist <- cluster::daisy(x = glottodata, metric = "gower",
type = list(symm = symm, asymm = asymm, ordratio = ordratio, logratio = logratio),
weights = weights)
dist
glottodata
structure
structure <- glottodata[["structure"]]
# Specify column types and levels
if(!is.null(structure)){
# structure <- suppressMessages(dplyr::left_join(data.frame("colnames" = colnames(glottodata)), structure))
if(is.null(types)){types <- structure$type}
if(is.null(levels)){levels <- structure$levels}
if(is.null(weights)){
if(is.null(structure$weight)){weights <- rep(1, ncol(structure))}
if(!is.null(structure$weight)){weights <- structure$weight}
}
}
if(!is.null(types)){
symm <- which(types == "symm")
asymm <- which(types == "asymm")
numer <- which(types == "numeric")
fact <- which(types == "factor")
ordfact <- which(types == "ordered")
ordratio <- which(types == "ordratio")
logratio <- which(types == "logratio")
} else{message('No type column found in structure. Please add a column labelled type.')}
cbinary <- c(symm, asymm)
glottodata[cbinary] <- lapply(glottodata[cbinary], as.logical)
glottodata[numer] <- lapply(glottodata[numer], as.numeric)
glottodata[fact] <- lapply(glottodata[fact], as.factor)
glottodata[ordfact] <- mapply(FUN = as.ordfact, x = glottodata[ordfact], levels = levels[ordfact])
glottodata[ordratio] <- lapply(glottodata[ordratio], as.numeric)
glottodata[logratio] <- lapply(glottodata[logratio], as.numeric)
dist <- cluster::daisy(x = glottodata, metric = "gower",
type = list(symm = symm, asymm = asymm, ordratio = ordratio, logratio = logratio),
weights = weights)
dist
load_all()
glottodata <- glottoget(meta = TRUE)
glottodist <- glottodist(glottodata = glottodata)
glottodist
create_structuretable()
glottodata <- glottoget(meta = FALSE)
structure <- create_structuretable()
glottodata <- glottodata_addtable(glottodata, structure)
glottodata
funcsource(glottodata_addtable())
funcsource(glottodata_addtable)
glottodata
glottodata <- glottoget()
glottodata
structure
c(glottodata, structure)
table <- structure
table
list(glottodata, table)
glottodata <- list("glottodata" = glottodata, table)
glottodata
names(glottodata)
name = "structure"
list("glottodata" = glottodata, name = table)
glottodata <- glottoget(meta = TRUE)
table
c(glottodata, table)
list(table)
table <- list(table)
table
names(table)
names(table) <- name
table
glottodata
c(glottodata, table)
table
c(glottodata, table)
structure <- create_structuretable()
structure
table <- structure
table <- list(table)
names(table) <- name
if(!is.list(glottodata)){
glottodata <- list("glottodata" = glottodata)
}
c(glottodata, table)
table <- list("structure" = table)
table
table
table <- list("structure" = create_structuretable())
table
list(table)
names(table)
table
length(table)
table
load_all()
glottodata <- glottoget(meta = FALSE)
structure <- create_structuretable()
glottodata <- glottodata_addtable(glottodata, structure)
structure
glottodata
glottodata <- glottoget(meta = FALSE)
glottodata
structure <- create_structuretable()
structure
glottodata_addtable(glottodata, structure)
table <- structure
is.list(table)
length(table)
list(table)
is.list(table)
class(table)
is_list(table)
is_list(table)
load_all()
glottodata <- glottoget(meta = FALSE)
structure <- create_structuretable()
glottodata_addtable(glottodata, structure)
glottodata <- glottodata_addtable(glottodata, structure, name = "structure")
glottodata
glottodata <- glottoget(meta = FALSE)
glottodata
structure <- create_structuretable()
structure
glottodata_addtable(glottodata, structure, name = "structure")
load_all()
glottodata_addtable(glottodata, structure, name = "structure")
?geodist
glottodata <- glottoget()
glottodata
class(glottodata)
load_all()
class(glottodata)
load_all()
glottodata <- glottoget()
glottodataspace <- glottospace(glottodata)
glottodataspace
geodist(points = glottodataspace)
document()
load_all()
install(force = TRUE)
