distmat
dist <- condist
any(class(dist) == "dist")
distmat <- as.matrix(dist)
distmat
rowna <- rowSums(is.na(distmat))
rowna
colna <- colSums(is.na(distmat))
colna
k=2
nmds <- vegan::metaMDS(comm = distmat, k = k)
nmds_res <- as.data.frame(vegan::scores(nmds))
nmds_res
tibble::rownames_to_column(nmds)
tibble::rownames_to_column(nmds_res)
?tibble::rowid_to_column
tibble::rownames_to_column(nmds_res, "label")
nmdsx <- vegan::metaMDS(comm = distmat, k = k)
nmdsx
class(nmdsx)
mds <- nmdsx
mds
nmds_res <- as.data.frame(vegan::scores(mds))
nmds_res <- tibble::rownames_to_column(nmds_res, "label")
nmds_res
mds
nmds_res
nmds
document()
load_all()
nmds_scores(nmds)
load_all()
nmds_scores(nmds)
isolates
glottofilter(nmds_scores$id)
nmds_scores
load_all()
scores <- nmds_scores(nmds)
scores
glottofilter(scores$id)
glottofilter(glottodata = glottodata, scores$id)
glottofilter(glottodata = glottodata(), scores$id)
glottofilter(glottodata = get_glottolog(), scores$id)
glottofilter(glottodata = glottobase, scores$id)
glottobase
scores <- nmds_scores(nmds)
scores
?glottosearch
glottosearch(find = scores$id)
glottosearch(find = scores$id[1])
document()
load_all()
glottofilter(glottocode = scores$id)
glottocode <- scores$id
glottocode
selection <- glottocode
glottodata
glottodata <- glottobase
selection
glottodata %>%
dplyr::filter(glottocode %in% selection)
glottodata %>%
dplyr::filter(glottocode %in% selection[1])
glottodata %>%
dplyr::filter(glottocode %in% selection[[1]])
selection[[1]]
glottodata %>%
dplyr::filter(glottocode %in% "acha1250")
glottodata
glottodata <- glottodata()
glottodata <- get_glottolog()
gs_transform(glottodata)
?glottobase
data("glottobase")
x <- data("glottobase")
x
x <- data(glottobase)
x
?glottofilter
document()
?glottofilter
glottodata
scores
load_all()
scores <- nmds_scores(nmds)
scores
base::exists("glottodata")
glottodata
rm(glottodata)
base::exists("glottodata")
glottologdata <- get_glottolog("glottolog")
glottologdata
nrow(filter(glottologdata, level == "family")) == 0
filter(glottologdata, level == "family")
glottologdata
dplyr::filter(glottologdata, level == "family")
nrow(dplyr::filter(glottologdata, level == "family")) == 0
families <- glottologdata %>%
dplyr::filter(level == "family") %>%
dplyr::filter(family_id == "" & parent_id == "") %>%
dplyr::transmute(family_id = id, family_name = name)
families
load_all()
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata
load
load_all()
glottologdata <- get_glottolog("glottolog")
glottolog_addisolates(glottologdata)
glottologdata$family_id
glottologdata$family_name
n <- nrow(glottologdata[(glottologdata$family_id == ""), ])
n
glottologdata[(glottologdata$family_id == ""), ]
n <- nrow(glottologdata[(glottologdata$family_id == "") & (glottologdata$level != "family"), ])
n
glottologdata[(glottologdata$family_id == "") & (glottologdata$level != "family"), ]
glottologdata[(glottologdata$family_id == "") & (glottologdata$level != "family"), "isolate"] <- TRUE
glottologdata
(glottologdata$family_id == "") & (glottologdata$level != "family")
glottologdata$isolate <- ifelse([(glottologdata$family_id == "") & (glottologdata$level != "family"), TRUE, FALSE)
# set family name to isolate
glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
# Base R, generate sequential unique family_id
glottologdata[glottologdata$family_id == "", "family_id"] <- sprintf("isol%04d", seq(1,n))
glottologdata
}
( (glottologdata$family_id == "") & (glottologdata$level != "family") )
glottologdata$isolate <- ifelse( ( (glottologdata$family_id == "") & (glottologdata$level != "family") ), TRUE, FALSE)
glottologdata$isolate
sum(glottologdata$isolate)
glottologdata
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
load_all()
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata
glottologdata <- glottologdata %>%
group_by(family_id) %>%
mutate(family_size = n())
glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = n())
glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata$family_size == 1
glottologdata[glottologdata$family_size == 1,]
glottologdata[glottologdata$isolate == TRUE,]
glottologdata$family_id[glottologdata$isolate == TRUE,]
glottologdata$family_id[glottologdata$isolate == TRUE]
# # set family name to isolate
# glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
#                                               is.na(family_name), "isolate"))
# # Base R, generate sequential unique family_id
# glottologdata[glottologdata$family_id == "", "family_id"] <- sprintf("isol%04d", seq(1,n))
glottologdata$family_id[glottologdata$isolate == TRUE] <- NA
glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata$family_size
glottologdata[glottologdata$family_size==1, ]
glottologdata[is.na(glottologdata$family_id), ]
load_all()
glottolog_isolate(glottologdata)
glottologdata$isolate <- glottolog_isolate(glottologdata)
glottologdata[glottolog_isolate(glottologdata), ]
glottologdata
glottolog_isolate(glottologdata)
glottolog_isolate(glottologdata)
glottologdata <- get_glottolog("glottolog")
glottologdata[glottolog_isolate(glottologdata), ]
glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata$family_size[glottolog_isolate(glottologdata)]
glottolog_isolate(glottologdata)
glottologdata$family_size[glottolog_isolate(glottologdata)]
length(glottologdata$family_size[glottolog_isolate(glottologdata)])
glottologdata[glottologdata$family_size==427,]
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottologdata %>%
dplyr::filter(level == "language")
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata %>% dplyr::mutate(family_name = dplyr::replace(family_name,
is.na(family_name), "isolate"))
glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata[glottologdata$family_id == "", "family_id"]
glottologdata[glottolog_isolate(glottologdata), ]
glottologdata[glottolog_isolate(glottologdata), "family_id"]
glottologdata$isolate <-   ifelse(
( (glottologdata$family_id == "") & (glottologdata$level != "family") ),
TRUE, FALSE)
glottologdata[glottologdata$isolate, "family_id"]
glottologdata
glottologdata[glottolog_isolate(glottologdata), "family_id"] <- glottologdata[glottolog_isolate(glottologdata), "id"]
glottologdata
glottologdata$isolate <- glottolog_isolate(glottologdata)
# # set family name to isolate
glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata[glottolog_isolate(glottologdata), "family_id"] <- glottologdata[glottolog_isolate(glottologdata), "id"]
glottologdata[glottologdata$isolate == TRUE, ]
glottologdata$isolate
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata
glottologdata <- get_glottolog("glottolog")
glottologdata
glottologdata %>%
dplyr::filter(level == "family") %>%
# dplyr::filter(family_id == "" & parent_id == "") %>%
dplyr::transmute(family_id = id, family_name = name)
families <- glottologdata %>%
dplyr::filter(level == "family") %>%
# dplyr::filter(family_id == "" & parent_id == "") %>%
dplyr::transmute(family_id = id, family_name = name)
dplyr::left_join(x = glottologdata, y = families, by = "family_id")
load_all()
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata
glottologdata$isolate <- glottolog_isolate(glottologdata)
# # set family name to isolate
glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata
length(glottologdata$isolate)
length(glottologdata$isolate == T)
sum(glottologdata$isolate)
# assign glottocode to family_id
glottologdata[glottolog_isolate(glottologdata), "family_id"] <- glottologdata[glottolog_isolate(glottologdata), "id"]
glottologdata
glottologdata <- glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata
glottologdata$family_size[glottolog_isolate(glottologdata)]
glottologdata$family_size
glottologdata$isolate
glottologdata[glottologdata$isolate, "family_id"]
glottologdata[glottologdata$isolate, "id"]
# assign glottocode to family_id
glottologdata[glottologdata$isolate == TRUE, "family_id"] <- glottologdata[glottologdata$isolate == TRUE, "id"]
glottologdata[glottologdata$isolate == TRUE, "family_id"]
glottologdata <- glottologdata %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata
glottologdata$family_size
glottologdata$family_size[glottologdata$family_name == "isolate"]
glottologdata$family_name == "isolate"
glottologdata[glottologdata$family_name == "isolate", ]
drop = c("family", "dialect")
glottologdata %>% dplyr::filter(level == -drop)
glottologdata %>% dplyr::filter(level == drop)
glottologdata %>% dplyr::filter(level != "family")
glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata[glottologdata$family_name == "isolate", ]
glottologdata[glottologdata$family_name == "isolate", "family_size"]
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata[glottologdata$family_name == "isolate", "family_size"]
glottologdata$family_name == "isolate"
sum(glottologdata$family_name == "isolate")
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata$isolate <-   ifelse(
( (glottologdata$family_id == "") & (glottologdata$level != "family") ),
TRUE, FALSE)
glottologdata$isolate
sum(glottologdata$isolate)
glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata <- glottologdata %>% dplyr::mutate(family_name = replace(family_name,
is.na(family_name), "isolate"))
glottologdata$family_name
glottologdata$family_name=="isolate"
sum(glottologdata$family_name=="isolate")
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata$isolate <-   ifelse(
( (glottologdata$family_id == "") & (glottologdata$level != "family") ),
TRUE, FALSE)
# # set family name to isolate
glottologdata[glottologdata$isolate == TRUE, "family_name"] <- "isolate"
glottologdata$isolate
sum(glottologdata$isolate)
glottologdata[glottologdata$isolate == TRUE, "id"]
load_all()
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata
glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata
glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata %>% dplyr::filter(level != "dialects")
load_all()
glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata
glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata[glottologdata$family_name == "isolate", "family_size"]
glottologdata[glottologdata$family_name == "isolate", ]
glottologdata[glottologdata$isolate == TRUE, "family_size"]
glottologdata <- glottologdata %>%
dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
glottologdata[glottologdata$isolate == TRUE, "family_size"]
load_all()
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata %>%
# dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
ts <- glottologdata %>%
# dplyr::filter(level != "family") %>%
dplyr::group_by(family_id) %>%
dplyr::mutate(family_size = dplyr::n())
ts[ts$isolate==T]
ts[ts$isolate==T,]
ts[ts$isolate==T, "family_size"]
ts[ts$level=="family", "family_size"]
ts[ts$level=="family", ]
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottolog_rmfamilies(glottologdata)
glottologdata <- glottolog_addfamilysize(glottologdata)
load_all()
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottolog_rmfamilies(glottologdata)
glottologdata <- glottolog_addfamilysize(glottologdata)
glottologdata <- glottolog_addfamilysizerank(glottologdata)
glottologdata
glottologdata %>% dplyr::filter(level != "dialect")
load_all()
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottolog_rmfamilies(glottologdata)
glottologdata <- glottolog_addfamilysize(glottologdata)
glottologdata <- glottolog_addfamilysizerank(glottologdata)
glottologdata
levels(glottologdata$bookkeeping)
unique(glottologdata$bookkeeping)
glottologdata %>% dplyr::filter(bookkeeping == "False")
glottologdata %>%
dplyr::filter(bookkeeping == "False") %>%
dplyr::select(-bookkeeping)
load_all()
glottologdata <- glottolog_rmbookkeeping(glottologdata)
glottologdata
glottologdata %>%
dplyr::filter(family_id == "arti1236")
glottologdata %>%
dplyr::filter(family_id != "arti1236")
glottologdata %>%
dplyr::filter(family_id == "sign1238")
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottolog_rmfamilies(glottologdata)
glottologdata <- glottolog_addfamilysize(glottologdata)
glottologdata <- glottolog_addfamilysizerank(glottologdata)
glottologdata <- glottolog_rmbookkeeping(glottologdata)
glottologdata <- glottolog_rmartifam(glottologdata)
glottologdata <- glottolog_rmsignlangs(glottologdata)
load_all()
glottologdata <- glottolog_rmartifam(glottologdata)
glottologdata <- glottolog_rmsignlangs(glottologdata)
glottologdata
class(glottologdata) <- "glot"
class(glottologdata)
glottologdata
glottologdata <- get_glottolog("glottolog")
glottologdata <- glottolog_addfamilyname(glottologdata)
glottologdata <- glottolog_addisolates(glottologdata)
glottologdata <- glottolog_rmdialects(glottologdata)
glottologdata <- glottolog_rmfamilies(glottologdata)
glottologdata <- glottolog_addfamilysize(glottologdata)
glottologdata <- glottolog_addfamilysizerank(glottologdata)
glottologdata <- glottolog_rmbookkeeping(glottologdata)
glottologdata <- glottolog_rmartifam(glottologdata)
glottologdata <- glottolog_rmsignlangs(glottologdata)
glottologdata
colnames(glottologdata) == "id"
glottologdata[[colnames(glottologdata) == "id"]]
glottologdata[colnames(glottologdata) == "id"]
colnames(glottologdata) == "id" <- "glottocode"
glottologdata %>% dplyr::rename("glottocode" = "id", "isocode" = "iso639P3code")
names(glottologdata)
glottologdata <- glottologdata %>% dplyr::rename("glottocode" = "id", "isocode" = "iso639P3code")
names(glottologdata)
glimpse(glottologdata)
dplyr::glimpse(glottologdata)
glottologdata %>% dplyr::select(-level, -description)
glottologdata %>% dplyr::select(-c(level, description))
names(glottologdata)
dplyr::glimpse(glottologdata)
glottologdata %>% dplyr::select(-c(level, description,
markup_description,
"child_family_count"))
"level"
glottologdata %>% dplyr::select(-c("level", description,
markup_description,
"child_family_count"))
dplyr::glimpse(glottologdata)
glottologdata$child_dialect_count
glottologdata$child_family_count
sum(glottologdata$child_family_count)
sum(glottologdata$child_language_count)
grepl(glottologdata$glottocode, pattern =
"arti")
sum(grepl(glottologdata$glottocode, pattern =
"arti"))
sum(grepl(glottologdata$glottocode, pattern =
"yucu"))
sum(grepl(glottologdata$glottocode, pattern =
"cre"))
grepl(glottologdata$glottocode, pattern =
"cre")
glottologdata[grepl(glottologdata$glottocode, pattern =
"cre"),]
load_all()
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
load_all()
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
document()
load_all()
?glottobase
glottobase <- function(){
glottolog <- get_glottolog(data = "glottolog")
glottobase <- glottologbooster(glottologdata = glottolog)
# TODO: if download fails, load inbuilt glottobase (which won't be the latest version of glottolog)
}
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
load_all()
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
document()
document()
document()
document()
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
document()
glottofilter(glottodata = glottobase(), glottocode = glottocodes)
glottofilter(glottodata = glottobase(), glottocode = scores$glottocode)
document()
load_all()
glottofilter(glottodata = glottobase(), glottocode = scores$glottocode)
nmds
