---
output: rmarkdown::github_document
always_allow_html: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```



# glottospace

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

## R package for the geospatial analysis of linguistic and cultural data. 
    Examples include: matching linguistic datasets to their location, 
    calculating distances between languages based on their spatial location or linguistic features, 
    visualizing linguistic data on a map.

## Installation

You can install the development version of glottospace from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("SietzeN/glottospace")
```
## Introduction to glottospace

### Plotting language locations on a map
Imagine you're working with languages in a particular region, and want to visualize them on a map. With glottospace this is easy! You could for example filter all languages in South America, and show which ones of them are isolate languages:

```{r glottospoints_sa}
library(glottospace)

## Plot point data:
glottomap(continent = "South America", color = "isolate")
```

Languages are often represented with points, while in reality the speakers of a language can inhabit vast areas. Glottospace works with point and polygon data. When polygon data is not available, you can interpolate the points and plot those. 

```{r glottopols_sa}
## Filter by continent
glottopoints <- glottofilter(continent = "South America")
# Interpolate points to polygons:
glottopols <- points2pols(glottopoints, method = "voronoi", continent = "South America")
# Plot polygon data:
glottomap(glottodata = glottopols, color = "family_size_rank")

```

### Adding contextual data for specific languages

Imagine you are interested in a particular set of languages, and want to add some contextual information.

```{r glottosearch}
# Search languages:
glottosearch(find = "Dutsch")
```

There are 6 glots that resemble our search term. Let's check on [glottolog](https://glottolog.org/) if Dutch is the language we're looking for.

```{r online}
glottocode_online("dutc1256")
```

Yes, that's the one. Let's check where Dutch is located in comparison to other languages in the Netherlands. 
```{r}
dutchies <- glottofilter(country = "Netherlands")
```


Get and extract environmental data. 

```{r geodata}
elevation <- get_geodata(download = "elevation", country = "Netherlands")
elevdutchies <- extractgeodata(glottodata = dutchies, geodata = elevation)
```
Let's plot the elevation of the Dutchies:

```{r map_dutchies}
glottomap(glottodata = elevdutchies, color = "elevation", label = "name", ptsize = 0.85)
```


## Workflow of glottospace

The glottospace package offers several function families to work with spatio-linguistic data: 

1. glottoget: download glottodata from online sources, or load user-provided glottodata.
1. glottocreate: create empty glottodata structure, to add data manually. 
1. glottocheck: run interactive quality checks of user-provided glottodata.
1. glottoclean: clean-up glottodata.
1. glottoboost: upgrade glottodata.
1. glottojoin: join user-provided glottodata with other (often online) datasets. 
1. glottosearch: search [glottolog](https://glottolog.org/) database for languages, language families, glottocodes, etc. 
1. glottofilter: filter/subset glottodata based on linguistic and geographic features/variables.
1. glottodist: calculate differences/similarities between languages based on their features (linguistic, cultural, environmental, geographic, etc.).
1. glottoplot: visualizing differences/similarities between languages.

1. glottospace: make glottodata spatial, add coordinates, add spatial points or polygons to languages.
1. geoget: download geographic data from online sources, or load user-provided geographic data.
1. geotools: extract environmental data and add those to glottodata. 
1. geodist: calculate geographic distances between languages.
1. glottomap: visualize linguistic and cultural data on a map.
1. glottosave: save output generated by glottospace (data, figures, maps, etc.).

### glottoget
You can download glottodata from online sources or load locally stored glottodata (for example from an excel file or shapefile). In the example below, no filename is specified, therefore a dummy dataset is loaded. 

``` {r}
glottodata <- glottoget()
head(glottodata)
```

### glottocreate
You can generate empty data structures that help you to add your own data in a structured way. 

``` {r}
createglottodata(glottocodes = c("yucu1253", "tani1257"), variables = 3, meta = FALSE)
```

I've specified meta = FALSE, to indicate that we want to generate a 'flat' glottodata table. However, when creating glottodata, by default, several meta tables are included:

``` {r}
glottodata_meta <- createglottodata(glottocodes = c("yucu1253", "tani1257"), variables = 3)
summary(glottodata_meta)
```

The majority of these metatables are added for the convenience of the user. The 'structure' table is the only one that is required for some of the functions in the glottospace package. A structure table can also be added later:

``` {r}
create_structuretable(glottocodes = c("yucu1253", "tani1257"), varnames = c("var001", "var002", "var003"))
```

More complex glottodata structures can also be generated. For example, in cases where you want to distinguish between groups within each language. 
``` {r}
# Instead of creating a single table for all languages, you might want to create a list of tables (one table for each language)
createglottosubdata(glottocodes = c("yucu1253", "tani1257"), variables = 3, groups = c("a", "b"), n = 2, meta = FALSE)
```

### glottocheck
If you have your own data, you might want to do some interactive quality checks:

``` {r}
glottodata <- glottoget()
glottocheck(glottodata, diagnostic = FALSE)
```
I've now specified diagnostic = FALSE, but the default is to show some more extensive diagnostics (like a data coverage plot). 

You can also check the metadata:

``` {r}
glottodata <- glottoget(meta = TRUE)
checkmetadata(glottodata)
```

### glottoclean 
Once you've loaded glottodata, you might encounter some inconsistencies. For example, data-contributors might not have used a standardized way of coding missing values.

``` {r}
glottodata <- glottoget(meta = TRUE)
glottodata$structure
# glottodata <- glottoclean(glottodata)
```

### glottoboost 
Upgrade data.

### glottojoin
Join user-provided glottodata with other dataset., and integrating them to use their full potential.

### glottosearch 
search: search languages 

### glottofilter
filter, select, query

### glottodist
Quantify differences and similarities between languages
glottodistances: calculating similarities between languages based on linguistic/cultural features

### glottoplot
Visualizing differences (distances) between languages based on linguistic, cultural, and environmental features. 

### glottospace
ff  

### geoget
dd

## geotools
..

### geodist
geodistances: calculate distances between languages, nearest languages, etc.

### glottomap 
Visualizing linguistic and cultural data on a map

### glottosave 
Save output generated by glottospace (data, figures, maps, etc.). 
Output that has been exported from the glottospace package can be read from other software package, or loaded again with getglottodata. 


## Some basic concepts: data formats

The glottospace package has three built-in datasets: glottobase, glottospace, and userdata. 

```{r}
data(package = "glottospace")
```

1. glottobase: This is a boosted/enriched version of [glottolog](https://glottolog.org/) data. It is used as reference dataset in several functions. The glottocodes are used as unique IDs to match different data sources. 
``` {r, message = FALSE}
data("glottobase")
# For more information about glottobase
?glottobase
colnames(glottobase)
```

2. glottospace. A simple dataset with glottocodes and a geometry colum. The glottocodes are used to match a language to a location. 
``` {r}
glottospace <- get_glottospace()
head(glottospace)
```

3. userdata. This is user-provided data that consist of a glottocode and any number of linguistic and/or cultural variables (features). 
``` r
glottodata <- get_glottodata(meta = FALSE)
glottodata
```



